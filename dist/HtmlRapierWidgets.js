jsns.amd("hr.widgets.confirm",function(t){t(["require","exports"],function(t,e){"use strict";var r=function(){function t(){}return t.prototype.confirm=function(t){return new Promise(function(e,r){e(window.confirm(t)?!0:!1)})},t}();e.BrowserConfirm=r})}),jsns.amd("hr.widgets.crudpage",function(t){t(["require","exports","hr.widgets.jsonobjecteditor","hr.widgets.editableitemslist","hr.widgets.editableitem","hr.widgets.confirm"],function(t,e,r,o,i,n){"use strict";var s=function(){function t(){}return t}();e.CrudPageSettings=s;var a=function(){function t(t){var e=this;this.settings=t,this.listingActions=t.listingActions,void 0===this.listingActions&&(this.listingActions={}),void 0===t.itemNameProperty&&(t.itemNameProperty="name"),this.pageActions=t.pageActions,void 0===this.pageActions&&(this.pageActions={}),this.listingActions.edit=function(r){return e.edit(r,t.update)},this.listingActions.del=function(t){return e.deleteItem(t)},this.deleteConfirm=t.deletePrompt,void 0===this.deleteConfirm&&(this.deleteConfirm=new n.BrowserConfirm);var s={itemControllerConstructor:i.EditableItem,itemControllerContext:this.listingActions,getData:t.list,add:function(){return e.edit(null,t.create)},pageActions:this.pageActions};this.listingController=o.EditableItemsListController.GetCreator(s).create(t.listController)[0];var a={schema:t.schema,strongConstructor:t.strongConstructor};this.itemEditorController=r.JsonObjectEditor.GetCreator(a).create(t.itemEditorController)[0]}return t.prototype.refreshData=function(){var t=this;return this.listingController.showLoad(),Promise.resolve(this.settings.list()).then(function(e){t.listingController.setData(e),t.listingController.showMain()}).catch(function(e){throw t.listingController.showError(),e})},t.prototype.deleteItem=function(t){var e=this;return this.deleteConfirm.confirm("Delete "+t[this.settings.itemNameProperty]+" ?").then(function(r){if(r)return e.listingController.showLoad(),e.settings.del(t).then(function(t){return e.refreshData()})})},t.prototype.edit=function(t,e){var r=this;return this.itemEditorController.showLoad(),this.itemEditorController.show(),this.itemEditorController.clearError(),Promise.resolve(t).then(function(t){return r.itemEditorController.showMain(),r.goEdit(t,e)})},t.prototype.goEdit=function(t,e){var r=this;return this.itemEditorController.edit(t).then(function(t){if(void 0!==t){if(r.itemEditorController.showLoad(),void 0===e)throw new Error("Cannot save updates to item, no persistFunc given.");return Promise.resolve(e(t)).then(function(t){r.itemEditorController.close(),r.refreshData()}).catch(function(t){r.itemEditorController.showError(t);var o=r.itemEditorController.getData();throw r.goEdit(o,e),t})}})},t}();e.CrudPage=a})}),jsns.amd("hr.widgets.editableitem",function(t){t(["require","exports","hr.typeidentifiers"],function(t,e,r){"use strict";function o(t,e,o){var i=this;for(var n in e)r.isFunction(e[n])&&(i[n]=function(t){return function(r){r.preventDefault(),e[t](o)}}(n))}e.EditableItem=o})}),jsns.amd("hr.widgets.editableitemslist",function(t){t(["require","exports","hr.controller","hr.toggles"],function(t,e,r,o){"use strict";var i=function(){function t(){}return t}();e.EditableItemsListControllerSettings=i;var n=function(){function t(t,e){this.itemControllerConstructor=e.itemControllerConstructor,this.itemControllerContext=e.itemControllerContext,this.listing=t.getModel("listing"),this.load=t.getToggle("load"),this.main=t.getToggle("main"),this.error=t.getToggle("error"),this.formToggles=new o.Group(this.load,this.main,this.error),this.formToggles.activate(this.main),void 0!==e.add&&(this.addFunc=e.add);for(var r in e.pageActions)this[r]=e.pageActions[r]}return t.GetCreator=function(e){return new r.ControllerBuilder(t,e)},t.prototype.add=function(t){if(void 0!==this.addFunc)return t.preventDefault(),this.addFunc()},t.prototype.setData=function(t){var e=void 0;void 0!==this.itemControllerConstructor&&(e=r.createOnCallback(this.itemControllerConstructor,this.itemControllerContext)),this.listing.setData(t,e)},t.prototype.showLoad=function(){this.formToggles.activate(this.load)},t.prototype.showMain=function(){this.formToggles.activate(this.main)},t.prototype.showError=function(){this.formToggles.activate(this.error)},t}();e.EditableItemsListController=n})}),jsns.amd("hr.widgets.json-editor-plugin",function(t){var e=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};t(["require","exports","jdorn.json-editor","hr.models"],function(t,r,o,i){"use strict";function n(t,e){var r=new s(new o.JSONEditor(t,e));return void 0!==e&&void 0!==e.strongConstructor&&(r=new a(r,e.strongConstructor)),r}o.JSONEditor.defaults.theme="bootstrap3custom",o.JSONEditor.defaults.iconlib="bootstrap3",o.JSONEditor.defaults.disable_collapse=!0,o.JSONEditor.defaults.disable_edit_json=!0,o.JSONEditor.defaults.disable_properties=!0,o.JSONEditor.defaults.resolvers.unshift(function(t){if("boolean"===t.type)return"select"===t.format||t.options&&t.options.select?"select":"checkbox"});var s=function(){function t(t){this.appendData=this.setData,this.editor=t}return t.prototype.setData=function(t){this.editor.root.setValue(t,!0)},t.prototype.clear=function(){this.editor.root.setValue(null,!0)},t.prototype.getData=function(){return this.editor.getValue()},t.prototype.getEditor=function(){return this.editor},t}(),a=function(t){function r(e,r){t.call(this,e,r)}return e(r,t),r.prototype.getEditor=function(){return this.childModel.getEditor()},r}(i.StrongTypedModel);r.create=n})}),jsns.amd("hr.widgets.jsonobjecteditor",function(t){t(["require","exports","hr.toggles","hr.widgets.json-editor-plugin","hr.externalpromise","hr.controller"],function(t,e,r,o,i,n){"use strict";var s={path:null},a=function(){function t(t,e){var i=this;this.currentError=null,this.currentPromise=null,this.modeModel=t.getModel("mode"),this.titleModel=t.getModel("title"),this.errorModel=t.getModel("error"),this.formModel=o.create(t.getHandle("editorHolder"),{schema:e.schema,disable_edit_json:!0,disable_properties:!0,disable_collapse:!0,show_errors:"always",custom_validators:[function(t,e,r){return i.showCurrentErrorValidator(t,e,r)}],strongConstructor:e.strongConstructor}),this.formEditor=this.formModel.getEditor(),this.fieldWatcher=new u(this.formEditor),this.dialog=t.getToggle("dialog"),this.dialog.offEvent.add(this,this.closed),this.load=t.getToggle("load"),this.main=t.getToggle("main"),this.error=t.getToggle("error"),this.formToggles=new r.Group(this.load,this.main,this.error),this.formToggles.activate(this.main)}return t.GetCreator=function(e){return new n.ControllerBuilder(t,e)},t.prototype.edit=function(t){return this.currentPromise=new i.ExternalPromise,this.titleModel.setData(t),this.modeModel.setData("Edit"),this.formModel.setData(t),this.currentPromise.Promise},t.prototype.getData=function(){return this.formModel.getData()},t.prototype.submit=function(t){if(t.preventDefault(),null!==this.currentPromise){var e=this.getData(),r=this.currentPromise;this.currentPromise=null,r.resolve(e)}},t.prototype.closed=function(){if(null!==this.currentPromise){var t=this.currentPromise;this.currentPromise=null,t.resolve()}},t.prototype.showMain=function(){this.formToggles.activate(this.main)},t.prototype.showLoad=function(){this.formToggles.activate(this.load)},t.prototype.showError=function(t){var e="No error message";void 0!==t.message&&(e=t.message),this.errorModel.setData(e),this.formToggles.activate(this.error),this.currentError=t,this.formEditor.onChange(),this.main.on()},t.prototype.clearError=function(){this.fieldWatcher.clear(),this.currentError=null,this.formEditor.onChange(),this.formToggles.activate(this.main),this.errorModel.clear()},t.prototype.show=function(){this.dialog.on()},t.prototype.close=function(){this.dialog.off()},t.prototype.showCurrentErrorValidator=function(t,e,r){if(null!==this.currentError){if("root"===r)return{path:r,message:this.currentError.message};if(void 0!==this.currentError.errors){var o=this.errorPath(r),i=this.currentError.errors[o];if(void 0!==i)return this.fieldWatcher.watch(r,o,this.currentError),{path:r,message:i}}}return s},t.prototype.errorPath=function(t){return t.replace("root.","")},t}();e.JsonObjectEditor=a;var u=function(){function t(t){this.watchers={},this.formEditor=t}return t.prototype.watch=function(t,e,r){void 0!==this.watchers[t]&&this.watchers[t].clear(),this.watchers[t]=new l(this.formEditor,t,e,r)},t.prototype.clear=function(){for(var t in this.watchers)this.watchers[t].clear(),delete this.watchers[t]},t}(),l=function(){function t(t,e,r,o){var i=this;this.formEditor=t,this.path=e,this.errorObjectPath=r,this.currentError=o,t.watch(e,function(){return i.handler()})}return t.prototype.handler=function(){var t=this;this.currentError.errors.hasOwnProperty(this.errorObjectPath)&&delete this.currentError.errors[this.errorObjectPath],window.setTimeout(function(){return t.clear()},1)},t.prototype.clear=function(){this.formEditor.unwatch(this.path,this.handler)},t}()})}),jsns.amd("hr.widgets.loadlifecycle",function(t){t(["require","exports","hr.toggles"],function(t,e,r){"use strict";var o=function(){function t(){this.loadToggle="load",this.mainToggle="main",this.errorToggle="error"}return Object.defineProperty(t.prototype,"LoadToggle",{get:function(){return this.loadToggle},set:function(t){this.loadToggle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MainToggle",{get:function(){return this.mainToggle},set:function(t){this.mainToggle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ErrorToggle",{get:function(){return this.errorToggle},set:function(t){this.errorToggle=t},enumerable:!0,configurable:!0}),t}();e.LifecycleSettings=o;var i=function(){function t(t,e){void 0===e&&(e=new o),this.load=t.getToggle(e.LoadToggle),this.main=t.getToggle(e.MainToggle),this.error=t.getToggle(e.ErrorToggle),this.group=new r.Group(this.load,this.main,this.error)}return t.prototype.showLoading=function(){this.group.activate(this.load)},t.prototype.showMain=function(){this.group.activate(this.main)},t.prototype.showError=function(){this.group.activate(this.error)},t}();e.Lifecycle=i})}),jsns.amd("hr.widgets.miniswagger",function(t){t(["require","exports","hr.http"],function(t,e,r){"use strict";function o(t){return void 0===n[t]&&(n[t]=r.get(t)),Promise.resolve(n[t])}function i(t){return o(t).then(function(t){return t.definitions})}var n={};e.getSwaggerDoc=o,e.getSwaggerObjectSchemas=i})}),jsns.amd("hr.widgets.navmenu",function(t){t(["require","exports","hr.controller","hr.eventhandler"],function(t,e,r,o){"use strict";function i(){function t(t,e,o){void 0!==e&&(e=r.createOnCallback(e,o));var s={name:t,created:e};i.push(s),n.fire(s)}function e(){return i}var i=[],n=new o.EventHandler;this.itemAdded=n.modifier,this.add=t,this.getItems=e}function n(t){var e=s[t];return void 0===e&&(s[t]=e=new i),e}var s={};e.getNavMenu=n})}),jsns.amd("hr.widgets.pageddata",function(t){t(["require","exports","hr.http","hr.eventhandler"],function(t,e,r,o){"use strict";function i(t,e){function i(){n.fire();var e=t+"?page="+this.currentPage+"&count="+this.resultsPerPage;r.get(e).then(function(t){s.fire(t)}).catch(function(t){a.fire(t)})}var n=new o.EventHandler;this.updating=n.modifier;var s=new o.EventHandler;this.updated=s.modifier;var a=new o.EventHandler;this.error=a.modifier,this.resultsPerPage=e,this.currentPage=0,this.updateData=i}e.PagedData=i})}),jsns.amd("hr.widgets.pagenumbers",function(t){t(["require","exports","hr.toggles","hr.eventhandler"],function(t,e,r,o){"use strict";function i(t,e){function i(t){p.fire(t)}function n(t){return function(){i(m+t)}}function s(){var t=v.currentPage+1;t<h&&i(t)}function a(){var t=v.currentPage-1;t>=0&&i(t)}function u(){for(var t={previousPage:function(t){t.preventDefault(),a()},nextPage:function(t){t.preventDefault(),s()}},o=["on","off","active"],i=0,u="page"+i,l=e.getToggle(u,o);!r.isNullToggle(l);)c.push(l),d.add(l),t[u]=n(i),u="page"+ ++i,l=e.getToggle(u,o);e.setListener(t)}function l(){h=Math.floor(this.totalResults/this.resultsPerPage),this.totalResults%this.resultsPerPage!==0&&++h;var e,r=0;e=this.currentPage+g>h?h-f:this.currentPage-g,e<0&&(e=0),m=e,t.setData(function(t){return e===v.currentPage&&d.activate(c[r],"active","on"),e>=h&&c[r].off(),++r,e++ +1})}var c=[],h=0,d=new r.Group;u();var f=c.length,g=Math.floor(f/2),p=new o.EventHandler;this.pageChangeRequested=p.modifier;var m=0,v=this;this.currentPage=0,this.totalResults=0,this.resultsPerPage=0,this.updatePages=l}e.PageNumbers=i})}),jsns.amd("hr.widgets.prompt",function(t){t(["require","exports"],function(t,e){"use strict";var r=function(){function t(t,e){this.accepted=t,this.data=e}return t.prototype.isAccepted=function(){return this.accepted},t.prototype.getData=function(){return this.data},t}();e.PromptResult=r;var o=function(){function t(){}return t.prototype.prompt=function(t,e){return new Promise(function(o,i){var n=window.prompt(t,e),s=new r(null!==n,n);o(s)})},t}();e.BrowserPrompt=o})});
//# sourceMappingURL=HtmlRapierWidgets.js.map
